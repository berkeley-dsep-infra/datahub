nfsPVC:
  enabled: true
  nfs:
    serverIP: 10.50.250.234

jupyterhub:
  scheduling:
    userScheduler:
      nodeSelector:
        hub.jupyter.org/pool-name: core-pool
  proxy:
    chp:
      nodeSelector:
        hub.jupyter.org/pool-name: core-pool
    traefik:
      nodeSelector:
        hub.jupyter.org/pool-name: core-pool

  hub:
    nodeSelector:
      hub.jupyter.org/pool-name: core-pool
    config:
      Authenticator:
        admin_users:
            # infrastructure
            - sknapp
            - rylo
            - yuvipanda
            - felder
            - balajialwar
            # List of other admin users
            - rbarreto
            - pratik.sachdeva
            - aculich
            - cheng.ren
            - emily_grabowski
            - klganter
            - cvacano
    extraConfig:
      15-initalize-shared-groups: |
        # Initialize collab_groups, but override in secrets, before
        # extraConfig 25 below.
        collab_groups = {}

      25-roles-and-shared-accounts: |
        # Initialize load_groups, so that we can assign to it later.
        c.JupyterHub.load_groups = {}

        for collab_group, members in collab_groups.items():
          c.JupyterHub.load_groups[collab_group] = members
          print(f"Added group '{collab_group}' with members: {members}")

          # Add user associated with collab group
          collab_user = f"collab-{collab_group}"

          # Anyone who in a collab_group can admin and access the
          # user server, and can list users, of that group.
          print(f"Add role for '{collab_user}'")
          c.JupyterHub.load_roles.append(
            {
              "name": f"collab-access-{collab_group}",
              "scopes": [
                "admin-ui",
                f"list:users!user={collab_user}",
                f"admin:servers!user={collab_user}",
                f"access:servers!user={collab_user}",
              ],
              "groups": [collab_group],
            }
          )
  singleuser:
    cmd:
      - jupyterhub-singleuser
      - --LabApp.collaborative=true
      # https://jupyterlab-realtime-collaboration.readthedocs.io/en/latest/configuration.html#configuration
      - --YDocExtension.ystore_class=tmpystore.TmpYStore
    nodeSelector:
      hub.jupyter.org/pool-name: dlab-pool
    storage:
      type: static
      static:
        pvcName: home-nfs-v3
        subPath: "{username}"
    memory:
      guarantee: 4G
      limit: 8G
    image: {}
